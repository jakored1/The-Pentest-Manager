import { Table } from "antd";



function Nmap({commandInfo}) {

    // If we ran into an error while parsing nmap xml output
    if (commandInfo.module_specific_data === "Ran into an error while parsing nmap xml file output") {
        return (
            <div>
                {commandInfo.module_specific_data}
            </div>
        )
    }

    const columns = [
        {
            title: 'Port',
            dataIndex: 'port',
            key: 'key'
        },
        {
            title: 'Type',
            dataIndex: 'type',
            key: 'key'
        },
        {
            title: 'State',
            dataIndex: 'state',
            key: 'key'
        },
        {
            title: 'Service',
            dataIndex: 'service',
            key: 'key'
        }
    ]

    return (
        <div style={{ backgroundColor: 'rgb(0, 0, 0, 0.05)', padding: '5px' }}>
            <Table
                dataSource={JSON.parse(commandInfo.module_specific_data)} 
                columns={columns} 
                pagination={false}
                bordered
            />
        </div>
    )
}

export default Nmap;
